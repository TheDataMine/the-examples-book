= Apply Functions

== `tapply`

The https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/tapply[documentation definition] for `tapply` is a bit more specific than the others, where the arguments are now `(X, INDEX, FUN)`, with `X` being an object where the `split` function applies, `INDEX` is a factor by which `X` is grouped, and `FUN` is function as before.

To simplify this definition, we can say `tapply` applies `FUN` to `X` when `X` is grouped by `INDEX`.

=== Examples

==== Using the itcont1980 data, show the top 20 city-and-state pairs, according to the amount of money donated.

.Click to see solution
[%collapsible]
====
[source,R]
----
library(data.table)
myDF <- fread("/anvil/projects/tdm/data/election/itcont1980.txt", quote="")
names(myDF) <- c("CMTE_ID", "AMNDT_IND", "RPT_TP", "TRANSACTION_PGI", "IMAGE_NUM", 
                 "TRANSACTION_TP", "ENTITY_TP", "NAME", "CITY", "STATE", "ZIP_CODE", "EMPLOYER", "OCCUPATION", 
                 "TRANSACTION_DT", "TRANSACTION_AMT", "OTHER_ID", "TRAN_ID", "FILE_NUM", "MEMO_CD", "MEMO_TEXT", 
                 "SUB_ID")
     
head(sort(tapply(myDF$TRANSACTION_AMT, paste(myDF$CITY, myDF$STATE, sep=", "),sum, na.rm=TRUE), 
          decreasing=TRUE), n=20)
----

----
,
    17299729
NEW YORK, NY
    11345027
HOUSTON, TX
    7606806
DALLAS, TX
    4748262
LOS ANGELES, CA
    4569952
WASHINGTON, DC
    4273606
CHICAGO, IL
    3179470
SAN FRANCISCO, CA
    2061441
BEVERLY HILLS, CA
    2053148
ATLANTA, GA
    1892356
OKLAHOMA CITY, OK
    1751431
ST LOUIS, MO
    1639570
SAN ANTONIO, TX
    1583292
MIAMI, FL
    1541867
TULSA, OK
    1341956
GREENWICH, CT
    1340112
WASHINGTOM, DC
    1300341
MIDLAND, TX
    1210584
DENVER, CO
    1183471
CINCINNATI, OH
    1096983
----
====