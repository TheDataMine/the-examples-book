= Apply Functions

== `tapply`

The https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/tapply[documentation definition] for `tapply` is a bit more specific than the others, where the arguments are now `(X, INDEX, FUN)`, with `X` being an object where the `split` function applies, `INDEX` is a factor by which `X` is grouped, and `FUN` is function as before.

To simplify this definition, we can say `tapply` applies `FUN` to `X` when `X` is grouped by `INDEX`.

=== Examples

==== In the athlete_events file, find the average height of the athletes in each country (the country is the NOC column).


.Click to see solution
[%collapsible]
====
[source,R]
----
# read in data
library(data.table)
myDF <- fread("/anvil/projects/tdm/data/olympics/athlete_events.csv")
          
tapply(myDF$HEIGHT, myDF$NOC, sum, na.rm=TRUE)
----

----
AFG
    170.592592592593
AHO
    177.294117647059
ALB
    173
ALG
    174.702868852459
AND
    173.703703703704
ANG
    178.204081632653
ANT
    175.121739130435
ANZ
    176.730769230769
ARG
    176.604722343682
ARM
    171.937799043062
ARU
    173.219512195122
ASA
    175.666666666667
AUS
    176.874016916456
AUT
    177.369685767098
AZE
    172.717391304348
BAH
    177.440677966102
BAN
    166.1875
BAR
    176.598958333333
BDI
    172.631578947368
BEL
    176.143175487465
BEN
    173.683333333333
BER
    177.405797101449
BHU
    166.51724137931
BIH
    178.633928571429
BIZ
    175.054794520548
BLR
    174.25644028103
BOH
    174
BOL
    171.295652173913
BOT
    175.809523809524
BRA
    177.637147102526
BRN
    173.424528301887
BRU
    166.111111111111
BUL
    172.830911492734
BUR
    176
CAF
    179.276595744681
CAM
    166.719298245614
CAN
    174.978715551181
CAY
    179.506849315069
CGO
    174.585365853659
CHA
    176.558823529412
CHI
    174.986988847584
CHN
    172.602742529677
CIV
    176.415094339623
CMR
    173.634615384615
COD
    175.358208955224
COK
    171.324324324324
COL
    169.915219611849
COM
    170.866666666667
CPV
    175.888888888889
CRC
    174.304761904762
CRO
    183.613173652695
CRT
    NaN
CUB
    174.908227848101
CYP
    176.675392670157
CZE
    178.169428113308
DEN
    179.200996677741
DJI
    173.41935483871
DMA
    174.888888888889
DOM
    172.216981132075
ECU
    171.142857142857
EGY
    178.10447761194
ERI
    169.945945945946
ESA
    169.560693641618
ESP
    174.921725239617
EST
    179.301863354037
ETH
    170.230113636364
EUN
    177.069637883008
FIJ
    177.420289855072
FIN
    175.757944557133
FRA
    175.254745496312
FRG
    177.641809290954
FSM
    161.24
GAB
    171.5
GAM
    170.55
GBR
    175.722488038278
GBS
    169.5
GDR
    175.553053435114
GEO
    175.010526315789
GEQ
    170.260869565217
GER
    177.344478899825
GHA
    173.881188118812
GRE
    176.783333333333
GRN
    175.166666666667
GUA
    171.148936170213
GUI
    172.887096774194
GUM
    176.585365853659
GUY
    174.47619047619
HAI
    173.930555555556
HKG
    172.2144
HON
    173.546762589928
HUN
    175.881506559458
INA
    167.488235294118
IND
    171.638608305275
IOA
    177.029411764706
IRI
    174.848973607038
IRL
    176.614285714286
IRQ
    173.889570552147
ISL
    181.245412844037
ISR
    173.245346869712
ISV
    177.933333333333
ITA
    175.298943443132
IVB
    178.631578947368
JAM
    176.168511685117
JOR
    173.188405797101
JPN
    168.228163049232
KAZ
    175.465682656827
KEN
    171.981481481481
KGZ
    178.075
KIR
    166.909090909091
KOR
    171.992277992278
KOS
    173.5
KSA
    173.144385026738
KUW
    174.5
LAO
    166.43137254902
LAT
    179.644501278772
LBA
    168.465517241379
LBR
    173.611111111111
LCA
    174.888888888889
LES
    167.254901960784
LIB
    173.363228699552
LIE
    175.282608695652
LTU
    182.099502487562
LUX
    173.872641509434
MAD
    168.464285714286
MAL
    167.25
MAR
    173.593220338983
MAS
    170.490280777538
MAW
    165.95
MDA
    176.018018018018
MDV
    163.761904761905
MEX
    171.912114989733
MGL
    169.133470225873
MHL
    168.538461538462
MKD
    174.890410958904
MLI
    180.606557377049
MLT
    169.918604651163
MNE
    183.563829787234
MON
    176.260869565217
MOZ
    172.631578947368
MRI
    174.342342342342
MTN
    173.607142857143
MYA
    166.106382978723
NAM
    172.859154929577
NBO
    NaN
NCA
    169.666666666667
NED
    179.488906497623
NEP
    163.905882352941
NFL
    170
NGR
    174.71829105474
NIG
    172.4
NOR
    178.002397362901
NRU
    167.181818181818
NZL
    177.832850241546
OMA
    169.65625
PAK
    173.910081743869
PAN
    171.882352941176
PAR
    176.584158415842
PER
    173.545232273839
PHI
    170.268060836502
PLE
    169.666666666667
PLW
    165.458333333333
PNG
    170.425742574257
POL
    175.265043478261
POR
    173.525
PRK
    161.557959814529
PUR
    177.376196990424
QAT
    178.325581395349
RHO
    169.333333333333
ROT
    169.916666666667
ROU
    172.553622361666
RSA
    177.785383903793
RUS
    176.214418508573
RWA
    167.916666666667
SAA
    159.666666666667
SAM
    174.826086956522
SCG
    187.511400651466
SEN
    180.178885630499
SEY
    175.5
SGP
    171.07662835249
SKN
    175.205128205128
SLE
    177.039603960396
SLO
    177.226744186047
SMR
    176.528662420382
SOL
    169.230769230769
SOM
    176
SRB
    184.635204081633
SRI
    169.626016260163
SSD
    173.333333333333
STP
    172.333333333333
SUD
    173.902173913043
SUI
    175.22161259542
SUR
    171.368421052632
SVK
    178.170192307692
SWE
    177.942063638036
SWZ
    171.527272727273
SYR
    174.454545454545
TAN
    169.637583892617
TCH
    174.917967332123
TGA
    179.305555555556
THA
    168.354166666667
TJK
    174.569230769231
TKM
    173.245283018868
TLS
    161.444444444444
TOG
    172.698113207547
TPE
    169.622390891841
TTO
    176.974137931034
TUN
    178.528409090909
TUR
    173.814699792961
TUV
    165.75
UAE
    172.653846153846
UAR
    181
UGA
    172.058295964126
UKR
    174.187474416701
UNK
    NaN
URS
    175.063242698892
URU
    176.353623188406
USA
    176.886903156191
UZB
    176.015283842795
VAN
    169.290322580645
VEN
    174.14412136536
VIE
    165.13698630137
VIN
    177.04347826087
VNM
    165.763157894737
WIF
    178
YAR
    167.4
YEM
    167.96
YMD
    175
YUG
    178.646060606061
ZAM
    172.828125
ZIM
    173.364583333333
----
====

====  In the 5000_transactions csv file, find the total amount of money spent in 2016 altogether, and the total amount of money spent in 2017 altogether

.Click to see solution
[%collapsible]
====
[source,R]
----     
tapply(myDF$SPEND, myDF$YEAR, sum, na.rm=TRUE)
----

----
2016
    19051720.0099997
2017
    19183059.2999997
----
====